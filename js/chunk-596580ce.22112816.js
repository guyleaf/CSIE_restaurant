(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-596580ce"],{"25f0":function(t,i,e){"use strict";var s=e("6eeb"),n=e("825a"),a=e("d039"),r=e("ad6d"),o="toString",c=RegExp.prototype,d=c[o],l=a((function(){return"/a/b"!=d.call({source:"a",flags:"b"})})),u=d.name!=o;(l||u)&&s(RegExp.prototype,o,(function(){var t=n(this),i=String(t.source),e=t.flags,s=String(void 0===e&&t instanceof RegExp&&!("flags"in c)?r.call(t):e);return"/"+i+"/"+s}),{unsafe:!0})},ad6d:function(t,i,e){"use strict";var s=e("825a");t.exports=function(){var t=s(this),i="";return t.global&&(i+="g"),t.ignoreCase&&(i+="i"),t.multiline&&(i+="m"),t.dotAll&&(i+="s"),t.unicode&&(i+="u"),t.sticky&&(i+="y"),i}},ba09:function(t,i,e){"use strict";e("c566")},c566:function(t,i,e){},d9ca:function(t,i,e){},e4bb:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container"},[e("HistoryTable")],1)},n=[],a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("b-table",{attrs:{items:t.items,fields:t.fields,striped:"",responsive:"sm"},scopedSlots:t._u([{key:"cell(訂單狀態)",fn:function(i){return["已下單"==i.item.訂單狀態?e("span",{staticClass:"text-success"},[t._v(t._s(i.item.訂單狀態))]):"店家已確認"==i.item.訂單狀態?e("span",{staticClass:"text-info"},[t._v(t._s(i.item.訂單狀態))]):"準備中"==i.item.訂單狀態?e("span",{staticClass:"text-warning"},[t._v(t._s(i.item.訂單狀態))]):"運送中"==i.item.訂單狀態?e("span",{staticClass:"text-primary"},[t._v(t._s(i.item.訂單狀態))]):"已取消"==i.item.訂單狀態?e("span",{staticClass:"text-danger"},[t._v(t._s(i.item.訂單狀態))]):e("span",[t._v(t._s(i.item.訂單狀態))])]}},{key:"cell(評分)",fn:function(i){return[i.item.hideRating?t._e():e("div",{staticClass:"star"},t._l(t.list,(function(s,n){return e("div",{key:n,staticClass:"starXin"},[e("div",{on:{click:function(e){return t.clickStar(n,i)}}},[e("img",{attrs:{src:i.item.ratingStar>n?t.stara:t.starb},on:{mouseover:function(e){return t.hoverStar(n,i)},mouseleave:function(e){return t.unhoverStar(i)}}})])])})),0)]}},{key:"cell(顯示更多)",fn:function(i){return[e("b-button",{staticClass:"mr-2 detail",attrs:{size:"sm"},on:{click:function(e){return t.show(i)}}},[t._v(" "+t._s(i.detailsShowing?"Hide":"Show")+" Details ")])]}},{key:"row-details",fn:function(i){return[e("b-card",[e("div",{staticClass:"container row"},[e("div",{staticClass:"col-md-3"},t._l(i.item.datas,(function(i,s){return e("b-row",{key:s,staticClass:"mb-2"},[e("b-row",{staticClass:"mr-2"},[t._v(t._s(i.product_name))]),e("b-row",{staticClass:"mr-2"},[t._v("* "+t._s(i.quantity)+" :")]),null!=i.discount?e("b-row",{staticClass:"mr-2",class:{"line-throughdisplay":i.discount<1}},[t._v(t._s(i.price*i.quantity))]):t._e(),i.discount<1?e("b-row",{staticClass:"mr-2"},[t._v(" "+t._s(t.price(i))+" ")]):t._e(),i.discount<1&&null!=i.discount?e("b-row",{staticClass:"mr-2 discount pl-1 pr-1"},[t._v(" "+t._s(10*i.discount)+"折")]):t._e()],1)})),1),e("div",{staticClass:"col-md-3 align-self-end"},[e("b-row",{staticClass:"mb-2 justify-content-end"},[e("b-row",[t._v("運費：")]),e("b-row",{class:{"line-throughdisplay":i.item.isShippingCoupon,"mr-2":i.item.isShippingCoupon}},[t._v(t._s(i.item.fee))]),i.item.isShippingCoupon?e("b-row",{staticClass:"mb-2"},[t._v("0")]):t._e()],1),e("b-row",{staticClass:"mb-2 justify-content-end"},[e("b-row",[t._v("總金額："+t._s(t.totals(i.item.datas)))])],1)],1),i.item.hideRating?t._e():e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"row justify-content-center"},[e("textarea",{staticClass:"tA",attrs:{id:"text"+i.index,placeholder:t.items[i.index].comment,readonly:t.items[i.index].readonly}}),t._v(" "),e("div",{staticClass:"d-inline-block sb",attrs:{id:"disabled-wrapper"+i.index}},[e("b-button",{staticClass:"te",attrs:{disabled:t.items[i.index].ratingdisabled},on:{click:function(e){return t.submitRating(i)}}},[t._v("評價")])],1),t.items[i.index].isClicked?t._e():e("b-tooltip",{attrs:{target:"disabled-wrapper"+i.index}},[t._v("請先給予評分。")]),t.items[i.index].isRated?e("b-tooltip",{attrs:{target:"disabled-wrapper"+i.index}},[t._v("已留言")]):t._e()],1)])])])]}}])})],1)},r=[],o=(e("d3b7"),e("25f0"),{data:function(){return{list:[0,1,2,3,4],stara:"https://i.imgur.com/S1EjjXA.png",starb:"https://i.imgur.com/gONraUA.png",status:["已下單","店家已確認","準備中","運送中","已完成","已取消"],fields:["店家","日期","訂單狀態","評分","顯示更多"],items:[{id:0,seller_id:0,ratingStar:0,isClicked:!1,isRated:!1,readonly:!1,comment:"請留下您的評論。",ratingdisabled:!0,"店家":"Dickerson","日期":"2020-11-11 04:12:25","運輸時間":"null","地址":"null","訂單狀態":"4",fee:0,isShippingCoupon:!1,datas:[{name:123123,price:123,quantity:1,discount:1},{name:456,price:456,quantity:2}]},{ratingStar:0,isClicked:!1,isRated:!1,readonly:!1,comment:"請留下您的評論。",ratingdisabled:"disabled","店家":"Dickerson","日期":"Macdonald",datas:[{name:123123},{name:456}]}]}},methods:{price:function(t){return null==t.discount?"Free":isNaN(t.discount)?t.price*t.quantity:Math.round(t.price*t.quantity*t.discount)},totals:function(t){for(var i=0,e=0;e<t.length;e++)isNaN(t[e].discount)||null==t[e].discount?i+=t[e].price*t[e].quantity:i=Math.round(i+t[e].price*t[e].quantity*t[e].discount);return i},clickStar:function(t,i){var e=i.index;this.items[e].isClicked||i.detailsShowing||this.show(i),this.items[e].isRated||(this.items[e].isClicked=!0,this.items[e].ratingStar=t+1)},hoverStar:function(t,i){var e=i.index;this.items[e].isClicked||(this.items[e].ratingStar=t+1)},unhoverStar:function(t){var i=t.index;this.items[i].isClicked||(this.items[i].ratingStar=0)},submitRating:function(t){var i=t.index,e=document.getElementById("text"+i.toString()),s=e.value;this.items[i].isRated=!0,this.items[i].readonly=!0,this.items[i].comment=s,this.items[i].ratingdisabled=!this.items[i].ratingdisabled},show:function(t){var i;this.$http.get("/customer/orders/"+t.item.id,{headers:{Authorization:"Bearer "+this.$store.getters["auth/token"]}}).then((function(e){i=e.data,t.item.datas=[],t.item.coupon_item=[],t.item.comment=i.order.comment;for(var s=0;s<i.order_items.length;s++)t.item.datas.push({product_name:i.order_items[s].product_name,price:parseInt(i.order_items[s].price),quantity:parseInt(i.order_items[s].quantity),discount:parseFloat(i.order.discount)});0==i.order.coupon_type?t.item.isShippingCoupon=!0:t.item.isShippingCoupon=!1,t.item.fee=i.order.fee,t.toggleDetails()}))}},mounted:function(){var t=this;this.$axios.get(this.$url+"/customer/orders",{headers:{Authorization:"Bearer "+this.$store.getters["auth/token"]}}).then((function(i){t.items=[];for(var e=i.data,s=0;s<e.length;s++){var n=!1,a=!1,r=!1,o=!1,c=!1;4!=e[s].status&&(c=!0),!c&&e[s].stars>0&&(o=!0,a=!0,r=!0,n=!0),t.items.push({"訂單狀態":t.status[e[s].status],ratingStar:e[s].stars,hideRating:c,"日期":e[s].order_time,seller_id:e[s].seller_id,"店家":e[s].seller_name,id:e[s].order_id,isRated:a,readonly:r,ratingdisabled:n,isClicked:o})}})).catch((function(i){t.$store.dispatch("auth/invalidate"),t.$router.push("/")}))}}),c=o,d=(e("f59d"),e("2877")),l=Object(d["a"])(c,a,r,!1,null,"62a7ad1c",null),u=l.exports,m={name:"History",components:{HistoryTable:u},methods:{updateSelected:function(t){this.selected=t}},data:function(){return{selected:[]}}},p=m,h=(e("ba09"),Object(d["a"])(p,s,n,!1,null,null,null));i["default"]=h.exports},f59d:function(t,i,e){"use strict";e("d9ca")}}]);