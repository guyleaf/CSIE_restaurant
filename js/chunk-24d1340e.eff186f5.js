(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24d1340e"],{"0517":function(t,e,i){},1148:function(t,e,i){"use strict";var s=i("a691"),r=i("1d80");t.exports="".repeat||function(t){var e=String(r(this)),i="",n=s(t);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(i+=e);return i}},"408a":function(t,e,i){var s=i("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=s(t))throw TypeError("Incorrect invocation");return+t}},55536:function(t,e,i){"use strict";i("0517")},"6f0b":function(t,e,i){},b680:function(t,e,i){"use strict";var s=i("23e7"),r=i("a691"),n=i("408a"),a=i("1148"),o=i("d039"),c=1..toFixed,l=Math.floor,u=function(t,e,i){return 0===e?i:e%2===1?u(t,e-1,i*t):u(t*t,e/2,i)},d=function(t){var e=0,i=t;while(i>=4096)e+=12,i/=4096;while(i>=2)e+=1,i/=2;return e},m=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){c.call({})}));s({target:"Number",proto:!0,forced:m},{toFixed:function(t){var e,i,s,o,c=n(this),m=r(t),f=[0,0,0,0,0,0],p="",h="0",b=function(t,e){var i=-1,s=e;while(++i<6)s+=t*f[i],f[i]=s%1e7,s=l(s/1e7)},v=function(t){var e=6,i=0;while(--e>=0)i+=f[e],f[e]=l(i/t),i=i%t*1e7},g=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==f[t]){var i=String(f[t]);e=""===e?i:e+a.call("0",7-i.length)+i}return e};if(m<0||m>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(p="-",c=-c),c>1e-21)if(e=d(c*u(2,69,1))-69,i=e<0?c*u(2,-e,1):c/u(2,e,1),i*=4503599627370496,e=52-e,e>0){b(0,i),s=m;while(s>=7)b(1e7,0),s-=7;b(u(10,s,1),0),s=e-1;while(s>=23)v(1<<23),s-=23;v(1<<s),b(1,1),v(2),h=g()}else b(0,i),b(1<<-e,0),h=g()+a.call("0",m);return m>0?(o=h.length,h=p+(o<=m?"0."+a.call("0",m-o)+h:h.slice(0,o-m)+"."+h.slice(o-m))):h=p+h,h}})},da6a:function(t,e,i){"use strict";i("6f0b")},f99b:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("center",[i("div",{staticClass:"container row justify-content-start"},[i("div",{staticClass:"col-11"},[i("b-card",[i("h3",{staticClass:"Header"},[t._v("查詢列表")]),i("b-form-select",{attrs:{options:t.options},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),i("OrderTable")],1)],1)])])},r=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-table",{attrs:{items:t.items,fields:t.fields,striped:"",responsive:"sm"},scopedSlots:t._u([{key:"cell(訂單狀態)",fn:function(e){return[0==e.item.訂單狀態?i("span",{staticClass:"text-success"},[t._v(t._s(t.status[e.item.訂單狀態]))]):1==e.item.訂單狀態?i("span",{staticClass:"text-info"},[t._v(t._s(t.status[e.item.訂單狀態]))]):2==e.item.訂單狀態?i("span",{staticClass:"text-warning"},[t._v(t._s(t.status[e.item.訂單狀態]))]):3==e.item.訂單狀態?i("span",{staticClass:"text-primary"},[t._v(t._s(t.status[e.item.訂單狀態]))]):5==e.item.訂單狀態?i("span",{staticClass:"text-danger"},[t._v(t._s(t.status[e.item.訂單狀態]))]):i("span",[t._v(t._s(t.status[e.item.訂單狀態]))])]}},{key:"cell(評分)",fn:function(e){return[i("div",{staticClass:"star"},t._l(t.list,(function(s,r){return i("div",{key:r,staticClass:"starXin"},[i("img",{attrs:{src:e.item.ratingStar>r?t.stara:t.starb}})])})),0)]}},{key:"cell(顯示更多)",fn:function(e){return[i("b-button",{staticClass:"mr-2 detail",attrs:{size:"sm"},on:{click:function(i){return t.show(e)}}},[t._v(" "+t._s(e.detailsShowing?"Hide":"Show")+" Details ")])]}},{key:"row-details",fn:function(e){return[i("b-card",[i("div",{staticClass:"row"},[t._v(" 客戶暱稱: "+t._s(e.item.clientName))]),i("div",{staticClass:"container row"},[i("div",{staticClass:"col-md-4"},t._l(e.item.datas,(function(e,s){return i("b-row",{key:s,staticClass:"mb-2"},[i("b-row",{staticClass:"mr-2"},[t._v(t._s(e.product_name))]),i("b-row",{staticClass:"mr-2"},[t._v("* "+t._s(e.quantity)+" =")]),i("b-row",{staticClass:"mr-2",class:{"line-throughdisplay":e.discount<1}},[t._v(t._s(e.price*e.quantity))]),e.discount<1?i("b-row",{staticClass:"mr-2"},[t._v(" "+t._s(t.price(e))+" ")]):t._e(),e.discount<1?i("b-row",{staticClass:"mr-2 discount pl-1 pr-1"},[t._v(" "+t._s(10*e.discount)+"折")]):t._e()],1)})),1),i("div",{staticClass:"col-md-2 align-self-end"},[i("b-row",{staticClass:"mb-2 justify-content-end"},[i("b-row",[t._v("運費：")]),i("b-row",{class:{"line-throughdisplay":e.item.isShippingCoupon,"mr-2":e.item.isShippingCoupon}},[t._v(t._s(e.item.fee))]),e.item.isShippingCoupon?i("b-row",{staticClass:"mb-2"},[t._v("0")]):t._e()],1),i("b-row",{staticClass:"mb-2 justify-content-end"},[i("b-row",[t._v("總金額："+t._s(t.total(e.item.datas)))])],1)],1),i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"row justify-content-center"},[i("textarea",{staticClass:"tA",attrs:{id:"text"+e.index,placeholder:t.items[e.index].comment,readonly:t.items[e.index].readonly}}),i("div",{staticClass:"d-inline-block sb row",attrs:{id:"disabled-wrapper"+e.index}},[i("b-button",{staticClass:"te col-md-9",attrs:{disabled:t.items[e.index].ratingdisabled,variant:"primary"},on:{click:function(i){return t.submitRating(e)}}},[t._v(t._s(e.item.msg))]),i("b-button",{staticClass:"cancel col-md-3",attrs:{disabled:t.items[e.index].ratingdisabled,variant:"danger"},on:{click:function(i){return t.cancelOrder(e)}}},[t._v("取消")])],1),t.items[e.index].isFinish?i("b-tooltip",{attrs:{target:"disabled-wrapper"+e.index}},[t._v("已完成")]):t._e()],1)])])])]}}])})],1)},a=[],o=(i("b0c0"),i("b680"),{data:function(){return{list:[0,1,2,3,4],stara:"https://i.imgur.com/S1EjjXA.png",starb:"https://i.imgur.com/gONraUA.png",status:["已下單","店家已確認","準備中","運送中","已完成","已取消"],fields:["訂單編號","下單日期","訂單狀態","評分","顯示更多"],items:[{id:0,seller_id:0,ratingStar:3,readonly:!0,ratingdisabled:!1,comment:"不要加奶茶","訂單編號":"3","下單日期":"2020-01-07 08:00:00","運輸時間":"null","地址":"null","訂單狀態":0,msg:"下一步:店家已確認",isFinish:!1,fee:0,isShippingCoupon:!1,clientName:"Roger",datas:[{product_name:"玩火Passion Tea",price:50,quantity:2,discount:1}]}]}},methods:{price:function(t){return parseFloat(t.price*t.quantity*t.discount).toFixed(0)},total:function(t){var e=0;if(void 0!=t)for(var i=0;i<t.length;i++)e+=parseFloat(parseFloat(t[i].price*t[i].quantity*t[i].discount).toFixed(0));return e},submitRating:function(t){var e=this,i=t.index;this.$confirm("確定要更改狀態為"+this.status[this.items[i].訂單狀態+1],"","question").then((function(){e.items[i].訂單狀態+=1,4==e.items[i].訂單狀態?(e.items[i].msg="已完成",e.items[i].isFinish=!0,e.items[i].ratingdisabled=!e.items[i].ratingdisabled):(e.items[i].msg="下一步："+e.status[e.items[i].訂單狀態+1],e.items[i].isRated=!0,e.items[i].readonly=!0),e.$http.post("/seller/orders/update",{id:t.item.訂單編號,order:{status:t.item.訂單狀態}},{headers:{Authorization:"Bearer "+e.$store.getters["auth/token"]}}).then((function(t){e.$alert("更改成功","","success")})).catch((function(t){}))}))},cancelOrder:function(t){var e=this,i=t.index;this.$confirm("您確定要取消訂單嗎？","","warning").then((function(){e.items[i].訂單狀態=5,e.items[i].msg="已取消",e.items[i].isFinish=!0,e.items[i].ratingdisabled=!e.items[i].ratingdisabled,e.$http.post("/seller/orders/update",{id:t.item.訂單編號,order:{status:t.item.訂單狀態}},{headers:{Authorization:"Bearer "+e.$store.getters["auth/token"]}}).then((function(t){e.$alert("取消成功","","success")})).catch((function(t){}))}))},show:function(t){var e=this;this.$http.get("/seller/orders/"+t.item.訂單編號,{headers:{Authorization:"Bearer "+this.$store.getters["auth/token"]}}).then((function(i){var s=i.data;t.item.comment=s.order.comment,t.item.clientName=s.order.name,t.item.fee=s.order.fee,4==t.item.訂單狀態?(t.item.isFinish=!0,t.item.ratingdisabled=!t.item.ratingdisabled,t.item.msg=e.status[t.item.訂單狀態]):5==t.item.訂單狀態?(t.item.msg="已取消",t.item.isFinish=!0,t.item.ratingdisabled=!t.item.ratingdisabled):t.item.msg="下一步:"+e.status[t.item.訂單狀態+1],t.item.datas=[];for(var r=0;r<s.order_items.length;r++){var n=1;if(void 0!=s.coupon_items)for(var a=0;a<s.coupon_items.length;a++)s.coupon_items[a].product_id==s.order_items[r].product_id&&s.coupon_items[a].quantity<=s.order_items[r].quantity&&(n=s.order.discount);t.item.datas.push({product_name:s.order_items[r].product_name,price:s.order_items[r].price,quantity:s.order_items[r].quantity,discount:n})}t.toggleDetails()})).catch((function(t){}))}},computed:{},created:function(){var t=this;this.$http.get("/seller/orders",{headers:{Authorization:"Bearer "+this.$store.getters["auth/token"]}}).then((function(e){t.items=[];for(var i=e.data,s=0;s<i.length;s++)t.items.push({"訂單編號":i[s].order_id,ratingStar:i[s].stars,"下單日期":i[s].order_time,"訂單狀態":i[s].status,readonly:!0,ratingdisabled:!1});t.items.sort((function(t,e){return t.訂單狀態-e.訂單狀態}))})).catch((function(e){t.$router.push("/")}))}}),c=o,l=(i("da6a"),i("2877")),u=Object(l["a"])(c,n,a,!1,null,"67774cd2",null),d=u.exports,m={name:"OrderManage",components:{OrderTable:d},data:function(){return{filter:0,options:[{value:0,text:"已下單"},{value:1,text:"店家已確認"},{value:2,text:"準備中"},{value:3,text:"運送中"},{value:4,text:"已完成"},{value:5,text:"已取消"}]}}},f=m,p=(i("55536"),Object(l["a"])(f,s,r,!1,null,null,null));e["default"]=p.exports}}]);