(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-609d7e4f"],{"0fa5":function(t,o,e){"use strict";e.r(o);var a=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("body",[e("div",{staticClass:"container"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-md-8"},[e("ShopDescription",t._b({},"ShopDescription",t.Info,!1)),e("CouponCardGroup",{attrs:{id:"couponTab"}}),e("FoodCardGroup")],1)])])])},s=[],i=(e("a4d3"),e("e01a"),e("b0c0"),e("ac1f"),e("1276"),function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"container"},[e("CategoryTab",{staticClass:"tab",attrs:{foodCategory:t.hasProducts(t.foodCards)}}),t._l(t.hasProducts(t.foodCards),(function(o){return e("div",{key:o.categoryId,staticClass:"row"},[e("div",{staticClass:"row",attrs:{id:"category"}},[e("h1",[t._v(t._s(o.foodCategory))])]),e("div",{staticClass:"row fback"},t._l(t.sameTag(o.foodCategory,!0),(function(o){return e("FoodCard",t._b({key:o.foodId},"FoodCard",o,!1))})),1)])}))],2)}),r=[],n=(e("4de4"),e("7db0"),e("d3b7"),e("25f0"),e("429b")),c=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{directives:[{name:"b-hover",rawName:"v-b-hover",value:t.hoverCard,expression:"hoverCard"}],staticClass:"col-md-6 card-body",on:{click:t.showModal}},[e("b-modal",{ref:"my-modal",attrs:{id:"modal-sm",size:"sm","hide-header":"","hide-footer":"","hide-header-close":""}},[e("div",{staticClass:"container"},[e("b-img",{staticClass:"productImage",attrs:{src:t.imgPath,fluid:"",alt:"Responsive image"}}),e("div",{staticClass:"m-2"},[e("h3",{staticClass:"mt-3"},[t._v(t._s(t.foodName)+" ")]),e("p",[t._v(t._s(t.foodDescription)+" ")]),e("h4",{attrs:{"mt-3":""}},[t._v("備註")]),e("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter something...",rows:"3"},model:{value:t.text,callback:function(o){t.text=o},expression:"text"}}),e("div",{staticClass:"row m-2",staticStyle:{"justify-content":"space-around"}},[e("b-form-spinbutton",{staticStyle:{width:"7rem"},attrs:{id:"sb-inline",inline:"",step:"",size:"sm"},model:{value:t.spinValue,callback:function(o){t.spinValue=o},expression:"spinValue"}}),e("p",[t._v("totalPrice: "+t._s(t.total))]),e("b-button",{attrs:{size:"sm"},on:{click:t.confirmModal}},[t._v("CONFIRM")])],1)],1)],1)]),e("b-card",{attrs:{tag:"article"}},[this.soldOut?e("img",{staticClass:"soldOut",attrs:{src:t.noStock}}):t._e(),e("div",{staticClass:"row",class:{outOfStock:this.soldOut}},[e("b-col",{attrs:{md:"6"}},[e("b-card-title",[t._v(" "+t._s(t.foodName)+" ")]),e("b-card-text",{staticClass:"ellipsis"},[t._v(t._s(t.foodDescription))]),e("b-card-text",[t._v("$"+t._s(t.price))])],1),e("b-col",{attrs:{md:"6"}},[e("b-card-img",{staticClass:"rounded-0 productImage",attrs:{src:t.imgPath,alt:"Image"}})],1)],1)])],1)},u=[],d=(e("a9e3"),{name:"FoodCard",data:function(){return{change:!1,spinValue:1,text:"",noStock:e("131b")}},props:{tag:Array,foodName:String,imgPath:String,foodDescription:String,price:Number,soldOut:Boolean,foodId:Number},computed:{total:function(){return this.price*this.spinValue},dataToCart:function(){return[this.foodName,this.spinValue,this.price]},data:function(){return[{foodName:this.foodName,quantity:this.spinValue,foodPrice:this.price,id:this.foodId}]}},methods:{parseCookie:function(){for(var t,o=document.cookie.split("; "),e={},a=0,s=o.length;a<s;a++)t=o[a],t=t.split("="),e[t[0]]=t[1];return e},addToCookie:function(){var t=this.parseCookie()["productNum"];if(t=void 0!=t?parseInt(t,10)+1:1,null==this.$cookie.get("product")||null==this.$cookie.get("shopName"))this.$cookie.set("shopId",this.$router.currentRoute.params.id),this.$cookie.set("shopName",this.$router.currentRoute.params.shopName),this.$cookie.set("product",JSON.stringify(this.data));else{var o=this.$cookie.get("shopName"),e=this.$router.currentRoute.params.shopName,a=JSON.parse(this.$cookie.get("product"));if(o===e){this.change=!1;var s=this.checkItemExistCart(a,this.data[0]);-1!=s?a[s].quantity+=this.data[0].quantity:a.push(this.data[0]),this.$cookie.set("product",JSON.stringify(a))}else this.change=!0,this.changeShop(o,e)}},checkSameShop:function(){var t=this.$cookie.get("shopName"),o=this.$router.currentRoute.params.shopName;t!=o&&null!=this.$cookie.get("product")?(this.change=!0,this.cleanShopCart(t,o)):this.$refs["my-modal"].show()},checkItemExistCart:function(t,o){var e=-1;t.find((function(t,a){t.foodName===o.foodName&&(e=a)}));return e},changeShop:function(t,o){this.$cookie.set("shopId",this.$router.currentRoute.params.id),this.$cookie.set("shopName",this.$router.currentRoute.params.shopName),this.$cookie.set("product",JSON.stringify(this.data)),this.$alert("成功建立新訂單","","success")},cleanShopCart:function(t,o){var e=this;this.$confirm("您的訂單含有 "+t+" 提供的餐點。清空購物車，即可新增 "+o+" 提供的餐點。","","warning").then((function(){document.cookie="shopId=; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="shopName=; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="product=; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="coupon=; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="discount=; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="totalPrice=; expires=Thu, 01 Jan 1970 00:00:00 GMT",e.$alert("已清空購物車","","success").then((function(){e.$refs["my-modal"].show()}))}))},hoverCard:function(){},showModal:function(){null!=this.$store.getters["auth/token"]&&2!=this.$store.getters["auth/user"].permission||this.soldOut||(this.spinValue=1,this.checkSameShop())},confirmModal:function(){this.addToCookie(),this.$bus.$emit("addfunction",this.dataToCart),this.$refs["my-modal"].hide()}}}),l=d,h=(e("1702"),e("2877")),p=Object(h["a"])(l,c,u,!1,null,"8a3f3b9e",null),f=p.exports,m={name:"FoodCardGroup",components:{FoodCard:f,CategoryTab:n["a"]},data:function(){return{foodCategories:[],foodCards:[]}},methods:{sameTag:function(t,o){return this.foodCards.filter((function(e){return e.foodTag===t&&e.sellingState==o}))},hasProducts:function(t){return this.foodCategories.filter((function(o){return t.find((function(t){return o.foodCategory===t.foodTag}))}))}},created:function(){var t=this,o=this.$router.currentRoute.params.id;this.$axios.get(this.$url+"/restaurants/"+o+"/products").then((function(o){t.foodCards=[];for(var e=o.data,a=0;a<e.length;a++)t.foodCards.push({sellingState:e[a].status,soldOut:e[a].sold_out,foodId:e[a].id,foodName:e[a].name,price:e[a].price,imgPath:t.$url+e[a].image_path,foodDescription:e[a].description,foodTag:e[a].category_name});t.$bus.$emit("productsNumber",t.foodCards.filter((function(t){return 1==t.sellingState})).length)})),this.$axios.get(this.$url+"/restaurants/"+o+"/category").then((function(o){t.foodCategories=[];for(var e=o.data,a=0;a<e.length;a++)t.foodCategories.push({foodCategory:e[a].name,order:e[a].display_order});t.foodCategories.sort((function(t,o){return t.order-o.order}))}))},mounted:function(){function t(){var o=document.querySelector("#shopbody"),e=document.querySelectorAll(".fback");if(null==o||0==e.length)setTimeout(t.bind(this),100);else for(var a=0;a<e.length;a++)e[a].style.minWidth=o.clientWidth.toString()+"px"}t()}},g=m,C=(e("61b2"),Object(h["a"])(g,i,r,!1,null,"76ea19bf",null)),v=C.exports,b=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"container"},[e("div",{staticStyle:{"background-color":"white"}},[e("div",{staticClass:"tag mt-5"},[t._v("優惠卷")]),e("div",{staticClass:"couponField mb-5",staticStyle:{display:"flex","flex-direction":"row"}},t._l(t.couponCards,(function(t){return e("div",{key:t["coupon"].id},[e("CouponCard",{attrs:{code:t["coupon"].code,products:t["coupon_items"],discount:parseFloat(t["coupon"].discount),limitMoney:parseInt(t["coupon"].limit_money),expire:t["coupon"].end_time,type:t["coupon"].type}})],1)})),0)])])},_=[],y=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("b-card",{staticClass:"m-2",staticStyle:{"min-width":"360px",height:"140px"},attrs:{overlay:""}},[e("b-card-title",[t._v(t._s(t.code))]),0===t.type?e("b-card-text",[e("a",[t._v("滿"+t._s(t.limitMoney)+"元 ")]),e("a",{staticStyle:{color:"red"}},[t._v("免運費")])]):t._e(),1===t.type?e("b-card-text",[e("a",[t._v("滿"+t._s(t.limitMoney)+"元 ")]),e("a",{staticStyle:{color:"red"}},[t._v(t._s(10*t.discount)+"折")])]):t._e(),2===t.type?e("b-card-text",[t._l(t.products,(function(o,a){return e("a",{key:o.product_id},[t._v(" "+t._s(o.quantity)+" "+t._s(o.name)+" "),a!=t.products.length-1?e("a",[t._v("+")]):t._e()])})),e("a",{staticStyle:{color:"red"}},[t._v(t._s(10*t.discount)+"折")])],2):t._e(),e("b-card-text",[t._v("期限:"+t._s(t.expire))])],1)},$=[],k={name:"CouponCard",data:function(){return{}},props:{code:String,products:Array,discount:Number,limitMoney:Number,expire:String,type:Number},created:function(){},computed:{},methods:{}},x=k,S=Object(h["a"])(x,y,$,!1,null,"24a525f8",null),N=S.exports,w={name:"CouponCardGroup",components:{CouponCard:N},props:{},data:function(){return{couponCards:[]}},methods:{},watch:{},created:function(){var t=this,o=this.$router.currentRoute.params.id;this.$axios.get(this.$url+"/restaurants/"+o+"/coupons?include_expired=0").then((function(o){t.couponCards=o.data}))}},I=w,T=(e("af42"),Object(h["a"])(I,b,_,!1,null,"5b4d7b77",null)),O=T.exports,M=e("7fc3"),R={name:"Shop",components:{ShopDescription:M["a"],FoodCardGroup:v,CouponCardGroup:O},data:function(){return{Info:[],couponInfo:[]}},methods:{},watch:{},created:function(){var t=this,o=this.$router.currentRoute.params.id;this.$http.get("restaurants/"+o+"/Info").then((function(o){t.Info=[];var e=o.data;t.Info.push({description:e.description,joinDate:e.created_at.split(" ",1)[0],shopName:e.name,imgPath:"https://picsum.photos/900/250/?image=3",rate:parseFloat(Math.round(10*e.averageOfRatings))/10,numberOfRatings:parseInt(e.numberOfRatings),fans:parseInt(e.numberOfFans)})})),this.$http.get("restaurants/"+o+"/coupons?include_expired=0").then((function(o){t.couponInfo=o.data}))}},F=R,G=(e("9d0e"),Object(h["a"])(F,a,s,!1,null,"7fe30253",null));o["default"]=G.exports},1702:function(t,o,e){"use strict";e("6824")},"258c":function(t,o,e){},"61b2":function(t,o,e){"use strict";e("9521")},6824:function(t,o,e){},9521:function(t,o,e){},"9d0e":function(t,o,e){"use strict";e("258c")},af42:function(t,o,e){"use strict";e("eaa3")},eaa3:function(t,o,e){}}]);